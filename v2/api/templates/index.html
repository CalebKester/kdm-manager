<!doctype html>
<html ng-app="theWatcher" ng-controller="globalController">
 <title>{{ settings.application.title }}</title>
 <head>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-71038485-2', 'auto');
      ga('send', 'pageview');
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.min.js"></script>
    <script src="http://code.angularjs.org/1.5.3/angular-route.min.js"></script>
    <script src="/static/js/app.js"></script>
    <link rel="stylesheet" href="/static/css/style.css" />
 </head>


 <body>

    <h1>{{ settings.application.app_name }}</h1>
    <h2>{{ settings.application.title }}</h2>
    <h3> API Version {{ settings.api.version }}</h3>


    <table class="api_documentation public_routes">
        <tr><th colspan="3">PUBLIC ROUTES</th></tr>
        <tr>
            <td colspan="3">
                <p>
                    These routes <b>DO NOT</b> require authentication. Use them
                    to construct dashboard, "create new whatever" type views and
                    to look up game asset data that does not belong to any user.
                </p>
            </td>
        </tr>

        <tr class="ul">
            <th class="route">Route</th><th class="methods">Methods</th><th class="comment">Comment/Note</th>
        </tr>

        <tr class="ul">
            <td> <a href="/auth">/auth</a> </td>
            <td> POST </td>
            <td>
                <p>        
                    The KD:M API uses JSON Web Tokens (<a
                    href="https://jwt.io/">https://jwt.io</a>) to manage user
                    sessions and user authentication.
                </p>
                <p> POST some simple JSON to this route to authenticate: </p>
                <code>{"username": "demo@kdm-manager.com", "password": 
                "l33th4x0r"}</code>
                <p>...if your credential checks out, you get a token back. Easy!</p>
            </td>
        </tr>
        <tr class="ul">
            <td> <a href="/monster">/monster</a> </td>
            <td> GET, POST </td>
            <td>
                <p>
                    Accepts a "name" or "handle" parameter (via JSON) and
                    returns a JSON representation of a monster type game asset.
                    For example, POSTing to /monster with JSON such as this:
                </p>
                <code>{"name": "White Lion Lvl. 1"}</code>
                <p>...returns JSON like this: </p>
                <code>{"comment": "Lvl. 1", "handle": "white_lion", "name":
                "White Lion", "level": 1, "levels": 3, "sort_order": 0, "type":
                "quarry"}
                <p>Or, with a handle:</p>
                <code>{"handle": "manhunter"}</code>
                <p>...you get:</p>
                <code>{"handle": "manhunter", "name": "Manhunter", "levels": 4,
                "sort_order": 103, "type": "nemesis", "selectable": false, 
                "misspellings": ["THE MANHUNTER", "MAN HUNTER"]}
                </code>
            </td>
        </tr>
        <tr class="ul">
            <td> <a href="/new_settlement">/new_settlement</a></td>
            <td> GET </td>
            <td> Returns JSON representing available options for creating a new
            settlement, including expansions, pre-fab survivors, etc. Also
            includes subtitle/description elements. Use this to make "create
            new settlement" type views. </td>
        </tr>
        <tr class="ul">
            <td> <a href="/settings.json">/settings.json</a> </td>
            <td> GET</td>
            <td> Not strictly a part of the API, but sometimes useful. Hit this
            route to download an attachement of settings.cfg as JSON. </td>
        </tr>
        <tr class="ul">
            <td> <a href="/settings">/settings</a> </td>
            <td> GET </td>
            <td> Retrieve settings.cfg as JSON</td>
        </tr>
        <tr class="ul">
            <td> <a href="/world">/world</a> </td>
            <td> GET </td>
            <td> Retrieve a JSON representation of aggregate/world stats.</td>
        </tr>
    </table>


    <table class="api_documentation private_routes">
        <tr><th colspan="3">PRIVATE ROUTES</th></tr>
        <tr>
            <td colspan="3">
                <p>
                    Private routes require authentication via JWT (see above).
                </p>
            </td>
        </tr>

        <tr class="ul">
            <th class="route">Route</th><th class="methods">Methods</th><th class="comment">Comment/Note</th>
        </tr>

        <tr class="ul route_root">
            <th colspan="3"><b>Settlement Routes:</b> /settlement/&lt;action&gt;/&lt;settlement_id&gt;</th>
        </tr>
        <tr class="ul">
            <td> /settlement/get/&lt;settlement_id&gt; </td>
            <td> POST, OPTIONS </td>
            <td> Retrieve a serialized version of the settlement associated with
            &lt;settlement_id&gt; (to include all related user and game assets).</td>
        </tr>

        <tr class="ul route_root">
            <th colspan="3"><b>Survivor Routes:</b> /survivor/&lt;action&gt;/&lt;settlement_id&gt;</th>
        </tr>

    </table>


 </body>
</html>
